<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>–¢—É—Ä–Ω–∏—Ä—ã Standoff 2 ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to bottom, #111, #000);
    color: white;
  }
  header {
    text-align: center;
    padding: 40px 20px;
  }
  h1 {
    color: #facc15;
    font-size: 40px;
    margin-bottom: 10px;
  }
  .container {
    max-width: 800px;
    margin: auto;
    padding: 20px;
  }
  .card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid #facc15;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 30px;
    overflow: hidden;
  }
  .btn {
    background: #facc15;
    color: black;
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    width: 100%;
  }
  .btn:hover {
    background: #eab308;
  }
  .hidden {
    display: none;
  }
  input[type="text"], input[type="tel"] {
    width: 100%;
    padding: 10px;
    margin: 8px 0 16px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
  }
  label {
    font-size: 14px;
  }
  ul {
    padding-left: 20px;
  }
  li {
    margin-bottom: 6px;
    color: #facc15;
  }
  li.eliminated {
    text-decoration: line-through;
    opacity: 0.5;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  th, td {
    padding: 8px;
    border-bottom: 1px solid #facc15;
    text-align: center;
  }
  th {
    text-align: left;
  }
  .winner-btn {
    background: #28a745;
    color: white;
    border-radius: 6px;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    font-weight: bold;
    margin: 0 2px;
  }
  .winner-btn:hover {
    background: #218838;
  }
  @media (max-width: 500px) {
    h1 { font-size: 28px; }
  }
</style>
</head>
<body>
<header>
  <h1>üî• –¢—É—Ä–Ω–∏—Ä—ã Standoff 2</h1>
</header>
<div class="container">
  <div class="card">
    <h2>–¢—É—Ä–Ω–∏—Ä #3</h2>
    <p>–û–ø–∏—Å–∞–Ω–∏–µ: –¢—É—Ä–Ω–∏—Ä 5x5, –ø—Ä–∏–∑ ‚Äî 5000‚ÇΩ, –≤–∑–Ω–æ—Å ‚Äî 100‚ÇΩ/–∏–≥—Ä–æ–∫</p>
    <p>–î–∞—Ç–∞: 10 –∏—é–ª—è 2025, 18:00</p>
    <button class="btn" onclick="showRegistration()">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
  </div>

  <div id="registration" class="card hidden">
    <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
    <input type="tel" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–∫–∞–ø–∏—Ç–∞–Ω–∞)" id="phone" />
    <input type="text" placeholder="ID –∫–∞–ø–∏—Ç–∞–Ω–∞ –≤ Standoff 2" id="captainId" />
    <label><input type="checkbox" id="rules" /> –Ø –ø—Ä–æ—á–∏—Ç–∞–ª –∏ –ø—Ä–∏–Ω–∏–º–∞—é –ø—Ä–∞–≤–∏–ª–∞</label>
    <button class="btn" onclick="submitRegistration()">–î–∞–ª–µ–µ</button>
  </div>

  <div id="teamForm" class="card hidden">
    <h3>–°–æ—Å—Ç–∞–≤ –∫–æ–º–∞–Ω–¥—ã</h3>
    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã" id="teamName" />
    <div id="playersInputs"></div>
    <button class="btn" onclick="submitTeam()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É</button>
  </div>

  <div class="card">
    <h3>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</h3>
    <ul id="teams"></ul>
  </div>

  <div class="card">
    <h3>–¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–∞—Ç—á–µ–π</h3>
    <table>
      <thead>
        <tr>
          <th>–ö–æ–º–∞–Ω–¥–∞ 1</th>
          <th>–°—á–µ—Ç</th>
          <th>–ö–æ–º–∞–Ω–¥–∞ 2</th>
          <th>–°—á–µ—Ç</th>
          <th>–û—Ç–º–µ—Ç–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</th>
        </tr>
      </thead>
      <tbody id="matchesBody">
        <tr><td colspan="5" style="padding: 10px;">–ú–∞—Ç—á–∏ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  const teamSize = 5;

  function showRegistration() {
    document.getElementById("registration").classList.remove("hidden");
    document.getElementById("teamForm").classList.add("hidden");
  }

  function submitRegistration() {
    const phone = document.getElementById("phone").value.trim();
    const captainId = document.getElementById("captainId").value.trim();
    const rules = document.getElementById("rules").checked;
    if (!phone || !captainId || !rules) {
      alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –ø—Ä–∏–º–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞.");
      return;
    }
    document.getElementById("registration").classList.add("hidden");
    document.getElementById("teamForm").classList.remove("hidden");

    const playersContainer = document.getElementById("playersInputs");
    playersContainer.innerHTML = "";
    for (let i = 1; i <= teamSize; i++) {
      const input = document.createElement("input");
      input.type = "text";
      input.placeholder = `ID –∏–≥—Ä–æ–∫–∞ ${i}`;
      input.className = "player";
      playersContainer.appendChild(input);
    }
    window.tempCaptainId = captainId;
  }

  function submitTeam() {
    const name = document.getElementById("teamName").value.trim();
    const playersInputs = document.querySelectorAll(".player");
    const players = [...playersInputs].map(input => input.value.trim());
    if (!name || players.some(p => !p)) {
      alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –∏ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤.");
      return;
    }
    const team = {
      id: Date.now(), // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π id –∫–æ–º–∞–Ω–¥—ã
      name,
      captainId: window.tempCaptainId || "",
      players,
      eliminated: false // –ø–æ–º–µ—Ç–∫–∞ –≤—ã–ª–µ—Ç–∞
    };

    const teams = JSON.parse(localStorage.getItem("teamsData") || "[]");
    teams.push(team);
    localStorage.setItem("teamsData", JSON.stringify(teams));

    alert("–ö–æ–º–∞–Ω–¥–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞!");
    document.getElementById("teamName").value = "";
    playersInputs.forEach(input => input.value = "");
    document.getElementById("teamForm").classList.add("hidden");

    renderTeams();
    buildMatchesIfNeeded();
    renderMatches();
  }

  function renderTeams() {
    const teams = JSON.parse(localStorage.getItem("teamsData") || "[]");
    const ul = document.getElementById("teams");
    ul.innerHTML = "";
    if (teams.length === 0) {
      ul.innerHTML = "<li>–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥</li>";
      return;
    }
    teams.forEach(team => {
      const li = document.createElement("li");
      li.textContent = `${team.name} (–ö–∞–ø–∏—Ç–∞–Ω: ${team.captainId}; –ò–≥—Ä–æ–∫–∏: ${team.players.join(", ")})`;
      if (team.eliminated) li.classList.add("eliminated");
      ul.appendChild(li);
    });
  }

  function buildMatchesIfNeeded() {
    let matches = JSON.parse(localStorage.getItem("matchesData") || "[]");
    const teams = JSON.parse(localStorage.getItem("teamsData") || "[]");

    // –µ—Å–ª–∏ –º–∞—Ç—á–µ–π –Ω–µ—Ç, —Å–æ–∑–¥–∞—ë–º –ø–∞—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤—ã–ª–µ—Ç–µ–ª–∏
    if (matches.length === 0 && teams.length >= 2) {
      matches = [];
      const aliveTeams = teams.filter(t => !t.eliminated);
      for (let i = 0; i < aliveTeams.length; i += 2) {
        if (aliveTeams[i + 1]) {
          matches.push({
            id: Date.now() + i,
            team1: aliveTeams[i].name,
            team1Id: aliveTeams[i].id,
            score1: 0,
            team2: aliveTeams[i + 1].name,
            team2Id: aliveTeams[i + 1].id,
            score2: 0,
            winnerId: null // id –∫–æ–º–∞–Ω–¥—ã-–ø–æ–±–µ–¥–∏—Ç–µ–ª—è
          });
        }
      }
      localStorage.setItem("matchesData", JSON.stringify(matches));
    }
  }

  function renderMatches() {
    const matches = JSON.parse(localStorage.getItem("matchesData") || "[]");
    const teams = JSON.parse(localStorage.getItem("teamsData") || "[]");
    const tbody = document.getElementById("matchesBody");
    tbody.innerHTML = "";

    if (!matches.length) {
      tbody.innerHTML = `<tr><td colspan="5" style="padding: 10px;">–ú–∞—Ç—á–∏ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</td></tr>`;
      return;
    }

    matches.forEach(match => {
      const team1 = teams.find(t => t.id === match.team1Id);
      const team2 = teams.find(t => t.id === match.team2Id);
      if (!team1 || !team2) return;

      const tr = document.createElement("tr");

      // –ö–ª–µ—Ç–∫–∏ —Å –∏–º–µ–Ω–∞–º–∏ –∫–æ–º–∞–Ω–¥, –∑–∞—á—ë—Ä–∫–Ω—É—Ç—ã, –µ—Å–ª–∏ –≤—ã–ª–µ—Ç–µ–ª–∏
      const team1Class = team1.eliminated ? "eliminated" : "";
      const team2Class = team2.eliminated ? "eliminated" : "";

      // –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
      let winnerButtons = "";
      if (!match.winnerId) {
        winnerButtons = `
          <button class="winner-btn" onclick="setWinner(${match.id}, ${team1.id})">–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${team1.name}</button>
          <button class="winner-btn" onclick="setWinner(${match.id}, ${team2.id})">–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${team2.name}</button>
        `;
      } else {
        const winnerName = teams.find(t => t.id === match.winnerId)?.name || "‚Äî";
        winnerButtons = `<b style="color:#facc15">–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${winnerName}</b>`;
      }

      tr.innerHTML = `
        <td class="${team1Class}" style="text-align:left;">${team1.name}</td>
        <td>${match.score1}</td>
        <td class="${team2Class}" style="text-align:left;">${team2.name}</td>
        <td>${match.score2}</td>
        <td>${winnerButtons}</td>
      `;

      tbody.appendChild(tr);
    });
  }

  function setWinner(matchId, winnerTeamId) {
    const matches = JSON.parse(localStorage.getItem("matchesData") || "[]");
    const teams = JSON.parse(localStorage.getItem("teamsData") || "[]");

    const match = matches.find(m => m.id === matchId);
    if (!match) return;

    match.winnerId = winnerTeamId;

    // –£—Å—Ç–∞–Ω–æ–≤–∏–º –æ—á–∫–∏ (–ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –ø–æ–¥—Å—á—ë—Ç–∞)
    if (winnerTeamId === match.team1Id) {
      match.score1 = 10;
      match.score2 = 4;
    } else {
      match.score1 = 4;
      match.score2 = 10;
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–∞–Ω–¥ ‚Äî –ø—Ä–æ–∏–≥—Ä–∞–≤—à–∞—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ª–µ—Ç–∞–µ—Ç
    const loserId = (winnerTeamId === match.team1Id) ? match.team2Id : match.team1Id;
    const loserTeam = teams.find(t => t.id === loserId);
    if (loserTeam) {
      loserTeam.eliminated = true;
    }

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    localStorage.setItem("matchesData", JSON.stringify(matches));
    localStorage.setItem("teamsData", JSON.stringify(teams));

    renderTeams();
    renderMatches();
  }

  window.onload = () => {
    renderTeams();
    buildMatchesIfNeeded();
    renderMatches();
  };
</script>
</body>
</html>
